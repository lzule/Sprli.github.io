<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>关于Jetson的系统烧录与环境配置</title><meta name="description" content="No Pain No Gain"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><script>var _hmt = _hmt || [];
(function() {
var hm = document.createElement("script");
hm.src = "//hm.baidu.com/hm.js?" + 'a2b0a21b8323843c2fcd318760ad1079';
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hm, s);
})();</script><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="
一、准备

Ubuntu电脑 or 虚拟机（Ubuntu系统）
能够进行数据传输的Micro-USB数据线
显示屏 、HDMI转接线、键鼠

二、进行烧录（参考瑞泰教程）
2.1 系统软件包的下载
2.1.1 烧录所需文件集中在这两个文件夹中，在本部分我选择安装LT4 R32.7.1版本

2.1.2根据Jetson类型进行选择

2.1.3根据载板型号进行选择

2.1.4随便选择一个版本

2.1.5下载对应文件，其中rtso-6002对应位置即为载板型号

2.1.6选择对应版本的L4T文件

2.1.7下载相应文件

2.2 在PC端Ubuntu系统进行烧录环境准备
2.2.1 将上述文件拷贝至烧录主机同一目录下
2.2.2 解压 Linux Driver Package
$ tar -vxf J.."><script src="//unpkg.com/valine/dist/Valine.min.js"></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="李祖乐的博客" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">李祖乐's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">关于Jetson的系统烧录与环境配置</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%87%86%E5%A4%87"><span class="toc-text">一、准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%BF%9B%E8%A1%8C%E7%83%A7%E5%BD%95%EF%BC%88%E5%8F%82%E8%80%83%E7%91%9E%E6%B3%B0%E6%95%99%E7%A8%8B%EF%BC%89"><span class="toc-text">二、进行烧录（参考瑞泰教程）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E7%B3%BB%E7%BB%9F%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%9A%84%E4%B8%8B%E8%BD%BD"><span class="toc-text">2.1 系统软件包的下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%9C%A8PC%E7%AB%AFUbuntu%E7%B3%BB%E7%BB%9F%E8%BF%9B%E8%A1%8C%E7%83%A7%E5%BD%95%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-text">2.2 在PC端Ubuntu系统进行烧录环境准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E7%B3%BB%E7%BB%9F%E7%83%A7%E5%BD%95"><span class="toc-text">3.1 系统烧录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E9%85%8D%E7%BD%AE%E6%9D%BF%E5%AD%90%E7%B3%BB%E7%BB%9F"><span class="toc-text">3.4 配置板子系统</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E8%BF%9B%E8%A1%8C%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB%EF%BC%88%E8%A7%86%E6%83%85%E5%86%B5%E9%80%89%E6%8B%A9%EF%BC%89"><span class="toc-text">三、进行系统迁移（视情况选择）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-text">3.1 方法一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="toc-text">3.2 方法二</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%AE%89%E8%A3%85Jepack"><span class="toc-text">四、安装Jepack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1%E3%80%81%E5%9F%BA%E6%9C%AC%E6%AD%A5%E9%AA%A4"><span class="toc-text">4.1、基本步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3"><span class="toc-text">4.2 问题及解决</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F%E6%89%80%E9%9C%80%E7%9A%84%E5%8C%85"><span class="toc-text">五、安装系统所需的包</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E9%85%8D%E7%BD%AEcuda%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-text">5.1 配置cuda环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F%E7%BA%A7%E5%AE%89%E8%A3%85%E5%8C%85"><span class="toc-text">5.2 配置系统级安装包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEPython"><span class="toc-text">5.3 安装配置Python</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E5%AE%89%E8%A3%85jtop%E7%AE%A1%E7%90%86GPU"><span class="toc-text">5.4 安装jtop管理GPU</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-%E5%AE%89%E8%A3%85virtualenv%E6%9D%A5%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83"><span class="toc-text">5.5 安装virtualenv来创建虚拟环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%AE%89%E8%A3%85pytorch%E4%BB%A5%E5%8F%8Atorchvision"><span class="toc-text">六、安装pytorch以及torchvision</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-text">6.1 基本操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3"><span class="toc-text">6.2 问题及解决</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%AE%89%E8%A3%85opencv"><span class="toc-text">七、安装opencv</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%83%85%E5%BD%A2%E4%B8%80"><span class="toc-text">7.1 情形一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E6%83%85%E5%BD%A2%E4%BA%8C"><span class="toc-text">7.2 情形二</span></a></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/Jetson"><i class="tag post-item-tag">Jetson</i></a><a href="/tags/Pytorch"><i class="tag post-item-tag">Pytorch</i></a><a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0"><i class="tag post-item-tag">深度学习</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">关于Jetson的系统烧录与环境配置</h1><time class="has-text-grey" datetime="2023-05-18T08:07:49.654Z">2023-05-18</time><article class="mt-2 post-content"><p><img src="/images/Jetson/jetson_ruitai_pic.png" alt="cover"></p>
<h2 id="一、准备">一、准备</h2>
<ol>
<li>Ubuntu电脑 or 虚拟机（Ubuntu系统）</li>
<li>能够进行数据传输的Micro-USB数据线</li>
<li>显示屏 、HDMI转接线、键鼠</li>
</ol>
<h2 id="二、进行烧录（参考瑞泰教程）">二、进行烧录（参考瑞泰教程）</h2>
<h3 id="2-1-系统软件包的下载">2.1 系统软件包的下载</h3>
<p>2.1.1 烧录所需文件集中在这两个文件夹中，在本部分我选择安装LT4 R32.7.1版本</p>
<img src="/images/Jetson/image-20230311205757974.png" alt="image-20230311205757974" style="zoom:50%;" />
<p>2.1.2根据Jetson类型进行选择</p>
<img src="/images/Jetson/image-20230311205921697.png" alt="image-20230311205921697" style="zoom:50%;" />
<p>2.1.3根据载板型号进行选择</p>
<img src="/images/Jetson/image-20230311210038630.png" alt="image-20230311210038630" style="zoom:50%;" />
<p>2.1.4随便选择一个版本</p>
<img src="/images/Jetson/image-20230311210058553.png" alt="image-20230311210058553" style="zoom:50%;" />
<p>2.1.5下载对应文件，其中rtso-6002对应位置即为载板型号</p>
<img src="/images/Jetson/image-20230311210118374.png" alt="image-20230311210118374" style="zoom:50%;" />
<p>2.1.6选择对应版本的L4T文件</p>
<img src="/images/Jetson/image-20230311210156444.png" alt="image-20230311210156444" style="zoom:50%;" />
<p>2.1.7下载相应文件</p>
<img src="/images/Jetson/image-20230311210216935.png" alt="image-20230311210216935" style="zoom:50%;" />
<h3 id="2-2-在PC端Ubuntu系统进行烧录环境准备">2.2 在PC端Ubuntu系统进行烧录环境准备</h3>
<p>2.2.1 将上述文件拷贝至烧录主机同一目录下</p>
<p>2.2.2 解压 Linux Driver Package</p>
<p><code>$ tar -vxf Jetson_Linux_R32.7.1_aarch64.tbz2</code></p>
<p>2.2.3 设置根文件系统</p>
<ol>
<li>
<p>进入Linux Driver Package 的根文件系统目录</p>
<p><code>$ cd &lt;your_L4T_root&gt;/Linux_for_Tegra/roofs</code></p>
</li>
<li>
<p>解压 the Root File System ：</p>
<p><code>$ sudo tar -jxpf ../../Tegra_Linux_Sample-Root-Filesystem_R32.7.1_aarch64.tbz2</code></p>
</li>
</ol>
<p>2.2.4 安装 BSP 支持包</p>
<ol>
<li>
<p>将 Realtimes-L4T-<version>.tar 包解压到与 Linux_for_Tegra 文件夹同级目录下面，使用命令：</p>
<p><code>$ tar -xvf Realtimes-L4T-&lt;version&gt;.tar</code></p>
</li>
<li>
<p>进入到 Realtimes-L4T 文件夹，运行：</p>
<p><code>$ sudo ./install.sh</code><br>
安装成功会有 success 提示！</p>
</li>
<li>
<p>运行 apply_binaries.sh 脚本拷贝 NVIDIA 用户空间库进入目标文件系统<br>
<code>$ cd ../Linux_for_Tegra/</code><br>
<code>$ sudo ./apply_binaries.sh</code></p>
</li>
</ol>
<h3 id="3-1-系统烧录">3.1 系统烧录</h3>
<p>3.3.1先c将板子进入recovery模式，然后将板子与主机通过Micro-USB数据线连接，在PC端的Linux_for_Tegra目录下进行如下操作：<br>
<code>$ sudo ./flash.sh realtimes/rtso-&lt;model&gt; mmcblk0p1</code><br>
注意：rtso-<model>指的是板子型号，例如我使用的板子是rtso-6002E-v1.2，则命令为：<br>
<code>$ sudo ./flash.sh rtso-6002e-1.2v mmcblk0p1</code></p>
<p>3.3.2 可能遇到的问题</p>
<ol>
<li>
<p>板子型号查看，一般来说板子上会带有型号，若找不到可以咨询卖方</p>
<img src="/images/Jetson/image-20230311213021400.png" alt="image-20230311213021400" style="zoom:50%;" />
</li>
<li>
<p>关于输入选项，如下，可以发现红框圈中的有很多型号的选项，其中rtso-6002e表示rtso-6002-emmc板，rtso-6002则是另一种类型的板子，并且6002-emmc下还有v1.2、v1.3等型号，根据板子进行选择。（一定不要弄错，这些文件是与主板相配的）</p>
</li>
</ol>
<p><img src="/images/Jetson/image-20230311214628664.png" alt="image-20230311214628664"></p>
<p>3.3.3 报错一</p>
<p><img src="/images/Jetson/image-20230311214653624.png" alt="image-20230311214653624"></p>
<p>如上报错需考虑两个原因：</p>
<ol>
<li>主机与板子进行数据传输的Micro-USB数据线是否具有传输数据的作用，可以使用lsusb查看是否含有Nvidia Crop；</li>
<li>板子是否进入了recovery模式。</li>
</ol>
<p>3.3.4 报错二</p>
<p><img src="/images/Jetson/image-20230319005550878.png" alt="image-20230319005550878"></p>
<p>仔细观察可以发现问题在于一个<code>.py</code>文件执行错误，可以使用命令<code>$ sudo apt install python2.7 python3 python</code>安装python，然后重新烧录解决。</p>
<h3 id="3-4-配置板子系统">3.4 配置板子系统</h3>
<p>由于瑞泰板子是上电自启动的，将板子和显示屏以及键鼠连接，进入类似Ubuntu系统开机配置界面，除了地区选择上海外，其余保持默认即可。能够正常开机，则表明烧录成功。随后可以发现，其图形化界面和Ubuntu几乎没有什么区别。</p>
<h2 id="三、进行系统迁移（视情况选择）">三、进行系统迁移（视情况选择）</h2>
<h3 id="3-1-方法一">3.1 方法一</h3>
<p>3.1.1 查看SSD设备名称<br>
系统启动前，将SSD插入到板子的内存接口处（由于瑞泰板子自身装有一个120GB的内存卡，因此可以直接使用其自身的SSD卡即可）。系统启动后，使用<code>$ sudo fdisk -l</code>命令查看SSD设备名称，例如：nvme0n1、mmcblk1，本文使用mmcblk1为例。<br>
3.1.2 对SSD进行格式化<br>
如果SSD之前没有进行格式化，需要把SSD格式化后再使用。对于已挂载的SSD卡，需要使用umount卸载SSD卡，再格式化。卸载命令：<code>sudo umount /dev/mmcblk1</code>；格式化命令：<code>$ sudo mkfs.ext4 /dev/mmcblk1</code><br>
3.1.3 创建一个新的GPT分区<br>
<code>$ sudo parted /dev/mmcblk1 mklabel gpt</code><br>
3.1.4 添加分区<br>
<code>$ sudo parted /dev/mmcblk1 mkpart primary 0GB &lt;Size&gt;</code><br>
Size是分区的大小，最小8GB，建议可以将SSD卡内存全部添入<br>
例如：准备分区的大小是50GB，则命令是：<br>
<code>$ sudo parted /dev/mmcblk1 mkpart primary 0GB 50GB</code><br>
添加完分区后，使用<code>$ sudo fdisk -l</code>可以看到mmcblk1下新增一个分区，名为：mmcblk1p1</p>
<p>3.1.5 格式化分区<br>
<code>$ sudo mkfs.ext4 /dev/mmcblk1p1</code><br>
把分区格式化为ext4 格式<br>
3.1.6 拷贝roofs到SSD<br>
<code>$ sudo dd if=/dev/mmcblk0p1 of=/dev/mmcblk1p1 bs=1M</code><br>
其中mmcblk0p1是系统原先所在位置，mmcblk1p1则是我们的转移目标区域<br>
3.1.7 修复分区<br>
<code>$ sudo -s</code><br>
<code>$ fsck.ext4 /dev/mmcblk1p1</code><br>
若遇到输入yes or no，请全部输入yes</p>
<p>3.1.8 调整系统分区大小<br>
<code>$ sudo resize2fs /dev/mmcblk1p1</code></p>
<p>3.1.9 烧写从SD卡启动系统<br>
<code>$ sudo ./flash.sh realtimes/rtso-&lt;model&gt; mmcblk1p1</code><br>
这一步骤和烧录步骤一摸一样，需要注意的是目录位置、烧录系统文件与最开始烧录时是一样的，且目标位置名称变化了<br>
重新烧录完后，进入系统后，输入<code>$ df -h</code>可以看到mmcblk1p1成为根目录，系统已从SD卡启动。</p>
<h3 id="3-2-方法二">3.2 方法二</h3>
<p>[^参考博客]: <a target="_blank" rel="noopener" href="http://t.csdn.cn/Ne0Bk">http://t.csdn.cn/Ne0Bk</a>  <a target="_blank" rel="noopener" href="http://t.csdn.cn/ZrDlI">http://t.csdn.cn/ZrDlI</a></p>
<p>3.2.1 将SD卡进行格式化操作并挂载到系统下，操作如下：<br>
系统迁移的前提是将SD卡挂载到系统下，先需要使用如下命令将SD卡格式化为EXT4格式：<br>
<code>$ sudo mke2fs -t ext4 /dev/mmcblk1p1</code><br>
然后将SD卡挂载到/mnt下：<br>
<code>$ sudo mount /dev/mmcblk1p1 /mnt</code></p>
<p>3.2.2 克隆所需文件：</p>
<p><code>$ git clone https://github.com/jetsonhacks/rootOnNVMe.git</code></p>
<p>3.2.3 进入下载的文件夹中，<a target="_blank" rel="noopener" href="http://xn--copy-rootfs-ssd-gm6x791zrggm36j4oi1j3f.sh">编辑脚本文件copy-rootfs-ssd.sh</a>，然后运行该脚本，将系统复制到SSD中。<br>
<code>cd ./rootOnNVMe</code><br>
<code>sudo gedit ./copy-rootfs-ssd.sh</code><br>
将文件中的<code>/dev/nvme0n1p1 </code>修改为<code>/dev/mmcblk1</code><br>
<code>sudo ./copy-rootfs-ssd.sh</code></p>
<img src="/images/Jetson/image-20230311225106076.png" alt="image-20230311225106076" style="zoom: 80%;" />
<p>3.2.4 进入到<code>rootOnNVMe/data</code>目录下，修改其中的脚本文件:<code>setssdroot.sh</code>与<code>setssdroot.service</code>，将其中的<code>/dev/nvme0n1p1</code>修改为<code>/dev/mmcblk1</code>，方法同上。</p>
<p><img src="/images/Jetson/image-20230311225229373.png" alt="image-20230311225229373"></p>
<p>3.2.5 回到rootOnNVMe目录下，执行以下命令：<br>
<code>sudo ./setup-service.sh</code></p>
<p>成功后如下图：</p>
<img src="/images/Jetson/image-20230311225311334.png" alt="image-20230311225311334" style="zoom:50%;" />
<p>3.2.6 重新启动jetson板后，使用命令<code>$ df -h</code>查看，可以发现系统已经完成迁移</p>
<h2 id="四、安装Jepack">四、安装Jepack</h2>
<h3 id="4-1、基本步骤">4.1、基本步骤</h3>
<p>4.1.1 安装前信息确认以及更新软件源（在板子上进行）<br>
给Xavier NX安装软件之前需先确定jetson设备系统l4t版本，因为NVDIA jetpack跟该版本号具有一定的对应关系，如果版本号不对应会导致出现一些异常。具体的对应关系可以参考Jetpack的说明：</p>
<p>在Xavier NX设备上使用以下命令可以查看系统的L4T版本号：<br>
<code>$ head–n 1 /etc/nv_tegra_release</code></p>
<p>4.1.2 进入载板系统，打开SysteamSettings–&gt;Software&amp;Updates&gt;Ubuntu Software</p>
<p>4.1.3 下载安装Jetpack/sdkmanager并运行（在PC端Ubuntu系统上进行）<br>
[sdkmanager下载网址]: <a target="_blank" rel="noopener" href="https://developer.nvidia.com/drive/sdk-manager">https://developer.nvidia.com/drive/sdk-manager</a></p>
<p>选择安装最新版本的sdkmanager下载安装<br>
安装命令：<code>$ sudo dpkg -i sdkmage&lt;……&gt;.deb</code> or <code>$ sudo apt install ./sdkmanger-&lt;……&gt;.deb</code><br>
运行命令：<code>$ sdkmanager</code></p>
<p>运行界面和操作如下：</p>
<ol>
<li>
<p>登录界面（低版本可能无法登录）</p>
<img src="/images/Jetson/image-20230311232026679.png" alt="image-20230311232026679" style="zoom:50%;" />
</li>
<li>
<p>点击圈中的1、2，进行选择Jetson类型以及与LT4相对应的Jetpack版本，3取消勾选。如果2中未发现与其对应的Jetpack版本，则运行sdkmanager的命令改为：<code>$ sdkmanager --archivedversions</code>，其它操作不变。</p>
<img src="/images/Jetson/image-20230311232300525.png" alt="image-20230311232300525" style="zoom:50%;" />
</li>
<li>
<p>由于以及安装过系统，圈中的1取消勾选，圈中的2可以选择合适的位置（默认不变），圈中的3注意取消勾选<strong>Download now.Install later.<strong>点击</strong>continue</strong>。</p>
<img src="/images/Jetson/image-20230311233159191.png" alt="image-20230311232542687" style="zoom:50%;" />
</li>
<li>
<p>输入PC端Ubuntu主机密码</p>
<img src="/images/Jetson/image-20230311232559144.png" alt="image-20230311232559144" style="zoom:50%;" />
</li>
<li>
<p>圈中的1，实际上应是显示有设备连接的；圈中的2填写<strong>板子Ubuntu系统</strong>的Username和Password；随后点击Install。</p>
<img src="/images/Jetson/image-20230311233500272.png" alt="image-20230311233500272" style="zoom:50%;" />
</li>
<li>
<p>接着进入以下界面，这些指标都是板子的指标，如内存是否足够、网络是否连接等。</p>
<p><img src="/images/Jetson/image-20230311234633908.png" alt="image-20230311234633908"></p>
<p>7.最后出现接下来画面即成功</p>
<p><img src="/images/Jetson/image-20230319113455316.png" alt="image-20230319113455316"></p>
</li>
</ol>
<h3 id="4-2-问题及解决">4.2 问题及解决</h3>
<p>4.2.1 如上图，如果出现Internet connection问题，按照其指示可以采取如下方法解决：</p>
<ol>
<li>在jetson板上终端输入：<code>$ ping -c 3 www.nvidia.com</code></li>
</ol>
<p><img src="/images/Jetson/image-20230311234239264.png" alt="image-20230311234239264"></p>
<ol start="2">
<li>
<p>将出现的Ip地址放到jetson板子的/etc/hosts文件中</p>
</li>
<li>
<p>使用命令：<code>$ sudo gedit /etc/hosts</code></p>
</li>
</ol>
<p>​       在文件中添加一行：<code>23.48.214.59 nvidia.com</code></p>
<ol start="4">
<li>保存后点击Retry即可。</li>
</ol>
<p>如果上述方法行不通，则可能是sdkmanager<strong>版本不是最新</strong>造成的。</p>
<p>4.2.2 若出现第三个Accept to APT……错误，则可能是jetson板上的源未更新造成的。</p>
<ol>
<li>可以在jetson板上依次输入命令：</li>
</ol>
<p><code>$ sudo apt-get update</code> &amp;<code>$ sudo apt-get upgrade</code></p>
<ol start="2">
<li>
<p>更新完后Retry即可。</p>
</li>
<li>
<p>有时光多Retry几次可能就会成功。</p>
</li>
</ol>
<p>若上述操作失效，则可以替换Jetson板上的Ubuntu源（注意是<strong>Jetson源</strong>），重新更新尝试一下；或者退出sdkmanager重新弄一遍。</p>
<h2 id="五、安装系统所需的包">五、安装系统所需的包</h2>
<h3 id="5-1-配置cuda环境变量">5.1 配置cuda环境变量</h3>
<p><code>vi ~/.bashrc  # 打开/.bashrc文件</code><br>
将以下内容输入该文件中（末尾即可）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/cuda10.2/bin:<span class="token environment constant">$PATH</span> <span class="token comment"># cuda后跟的是cuda版本</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">LD_LIBRARY_PATH</span><span class="token operator">=</span>/usr/local/cuda10.2/lib64:<span class="token variable">$LD_LIBRARY_PATH</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CUDA_ROOT</span><span class="token operator">=</span>/usr/local/cuda10.2  <span class="token comment"># 这一项不是很确定是否有用</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="5-2-配置系统级安装包">5.2 配置系统级安装包</h3>
<p>输入以下命令即可</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> build-essential <span class="token function">make</span> cmake cmake-curses-gui
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">git</span> g++ pkg-config <span class="token function">curl</span>  <span class="token function">zip</span> zlib1g-dev libopenblas-base libopenmpi-dev 
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libatlas-base-dev gfortran libcanberra-gtk-module libcanberra-gtk3-module
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libhdf5-serial-dev hdf5-tools libhdf5-dev
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">nano</span> <span class="token function">locate</span> <span class="token function">screen</span>
<span class="token comment">#scipy 依赖和 cython</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libfreetype6-dev 
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> protobuf-compiler libprotobuf-dev openssl
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libssl-dev libcurl4-openssl-dev
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> cython3
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libxml2-dev libxslt1-dev
<span class="token comment">#opencv 依赖</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libavcodec-dev libavformat-dev libswscale-dev
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libxvidcore-dev libavresample-dev
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libtiff-dev libjpeg-dev libpng-dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="5-3-安装配置Python">5.3 安装配置Python</h3>
<p>5.3.1 默认安装python3.6版本</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> python3-dev python3-testresources python3-setuptools
<span class="token function">wget</span> https://bootstrap.pypa.io/pip/3.6/get-pip.py
<span class="token function">sudo</span> python3 get-pip.py <span class="token comment"># 该命令可能会失败，显示python3使用的python3.6版本较低，导致不成功，只要下载对应版本的pip就行，使用以下命令进行替换：wget https://bootstrap.pypa.io/pip/3.6/get-pip.py</span>
<span class="token function">rm</span> get-pip.py <span class="token comment"># 然后换pip源</span>
<span class="token function">mkdir</span> ~/.pip
<span class="token function">vim</span> ~/.pip/pip.conf <span class="token comment"># 换清华源</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>粘贴以下内容到该文件<br>
<code>[global] index-url = https://pypi.tuna.tsinghua.edu.cn/simple</code></p>
<p>5.3.2 解决sudo python3 get-pip.py失败，这里我选择使用python3.7版本</p>
<ol>
<li>安装python3.7</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> update  <span class="token comment"># 更新(可跳过)</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> python3.7
python3.7 <span class="token parameter variable">-V</span>  <span class="token comment">#查看是否安装成功</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li>创建软连接，使python3默认指向python3.7</li>
</ol>
<ul>
<li>首先把之前的软连接删除：</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /usr/bin/python3 
<span class="token function">which</span> python3.7  <span class="token comment"># 查看python3.7 安装路径.这里输出/usr/bin/python3.7</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ul>
<li>创建新的软连接：</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">ln</span> <span class="token parameter variable">-s</span> /usr/bin/python3.7 /usr/bin/python3  <span class="token comment"># 添加python3的软链接。 /usr/bin/python3.7 即 which python3.7输出的安装路径</span>
python3 <span class="token parameter variable">-V</span>  <span class="token comment"># 测试是否安装成功</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ol start="3">
<li>切换python版本，<br>
<a href="jetson%E5%8F%AF%E4%BB%A5%E5%AE%89%E8%A3%85minconda%E6%9D%A5%E4%BD%BF%E7%94%A8conda%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%EF%BC%8C%E4%BD%86%E6%98%AF%E4%B8%8D%E5%A6%82%E5%AE%89%E8%A3%85virtualenv%E6%9D%A5%E7%9A%84%E6%96%B9%E4%BE%BF%EF%BC%8C%E5%B9%B6%E4%B8%94%E5%8D%A0%E5%86%85%E5%AD%98%E4%B9%9F%E4%B8%8D%E5%B0%8F">^解释</a>: 对于不同版本的jetpack，其cuda对应的python版本有所不同，使用该方法便于配合cuda的使用</li>
</ol>
<ul>
<li>首先查看python文件<br>
<code>ls /usr/bin/python* # 查看python文件，会出现python2.7、python3.6、python3.7三个版本</code></li>
<li>首先看看系统是否配置过python相关的管理信息<br>
<code>update-alternatives --list python # 如果显示：no alternatives for python，表示没有配置过。</code></li>
<li>使用以下命令进行配置：</li>
</ul>
<pre name="code" class="python">
sudo update-alternatives --install /usr/bin/python python /usr/bin/python2.7 1
sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.6 2
sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.7 3
</pre>
<ul>
<li>配置成功，会提示你<code> in auto mode</code>.这个时候我们再次查看配置<br>
<code>update-alternatives --list python</code></li>
<li>会看到我们的三个版本已经成功进行了配置。如果需要切换版本，输入命令<br>
<code>sudo update-alternatives --config python #  然后输入相应的版本序号即可</code></li>
<li>最后使用：<code>python --version</code>查看版本号，可以发现配置成功</li>
</ul>
<h3 id="5-4-安装jtop管理GPU">5.4 安装jtop管理GPU</h3>
<p>输入命令安装jtop：<br>
<code>sudo -H pip install jetson-stats</code><br>
安装成功后，输入<code>sudo jtop</code>即可查看硬件相关信息</p>
<h3 id="5-5-安装virtualenv来创建虚拟环境">5.5 安装virtualenv来创建虚拟环境</h3>
<ol>
<li>安装与配置</li>
</ol>
<ul>
<li>使用pip下载virtualenv</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pip <span class="token function">install</span> virtualenv virtualenvwrapper
<span class="token function">vim</span> ~/.bashrc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ul>
<li>将以下内容输入其中：</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#virtualenv and virtualenvwrapper</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">WORKON_HOME</span><span class="token operator">=</span><span class="token environment constant">$HOME</span>/.virtualenvs <span class="token comment">#指定所有的需拟环境的安装位置</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">VIRTUALENVWRAPPER_PYTHON</span><span class="token operator">=</span>/usr/bin/python3.6 <span class="token comment">#指定解释器，改为cuda对应的python版本</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li>终端输入指令激活virtualenv</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token environment constant">$HOME</span>/.virtualenvs
<span class="token builtin class-name">source</span> /usr/local/bin/virtualenvwrapper.sh <span class="token comment">#进行激活生效</span>
<span class="token builtin class-name">source</span> ~/.bashrc <span class="token comment">#重新载入</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li>virtualenv的使用相关操作</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mkvirtualenv name <span class="token comment"># 创建一个环境</span>
mkvirtualenv <span class="token parameter variable">-p</span> /python目录/python.exe name <span class="token comment"># 不使用默认python版本、使用指定python版本创建环境</span>
workon name <span class="token comment"># 激活环境</span>
deactivate <span class="token comment"># 退出</span>
rmvirtualenv name <span class="token comment"># 删除</span>
lsvirtualenv <span class="token comment"># 所有环境</span>
cpvirtualenv source_name dest_name <span class="token comment"># 复制虚拟环境</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="六、安装pytorch以及torchvision">六、安装pytorch以及torchvision</h2>
<h3 id="6-1-基本操作">6.1 基本操作</h3>
<ol>
<li>创建虚拟环境<br>
[^声明]: 以创建虚拟环境名位torchli，安装1.10.0版本的pytorch和对应版本0.11.1的torchvision为例</li>
</ol>
<ul>
<li>使用以下命令创建虚拟环境</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Mkvirtualenv <span class="token parameter variable">-p</span> /usr/bin/python3.6 torchli <span class="token comment"># -p 后面跟着的是制定python的版本，因为有的pytorch对python版本有要求，所以要指定版本</span>
workon torchli <span class="token comment"># 进入虚拟环境</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ul>
<li>如果遇见<code>workon command not find</code>，则使用以下命令<br>
<code>Source virtualenvwrapper.sh</code></li>
<li>然后再<code>workon torchli</code></li>
</ul>
<ol start="2">
<li>安装pytorch</li>
</ol>
<ul>
<li>首先下载pytorch pip wheels（对应自己装的Jatpack的版本）<br>
[下载网址]:<a target="_blank" rel="noopener" href="https://forums.developer.nvidia.com/t/pytorch-for-jetson/72048">https://forums.developer.nvidia.com/t/pytorch-for-jetson/72048</a></li>
<li>下载完后，输入命令：</li>
</ul>
<pre name="code" class="python">
pip install torch-1.10.0-cp36-cp36m-linux_aarch64.whl # 安装pytorch
git clone --branch v0.11.1 https://github.com/pytorch/vision torchvision # 下载0.11.1版本
cd torchvision
export BUILD_VERSION=0.11.1
python setup.py install --user # --user可加可不加</pre>
<ol start="3">
<li>验证是否安装成功</li>
</ol>
<ul>
<li>上述操作完成后，输入命令：</li>
</ul>
<pre name="code" class="python">
python # 进入python：
import torch # 导入torch库
torch.cuda.is_available()  # 验证cuda是否能使用，输出应为True，则pytorch安装成功
import torchvision # 导入torchvision库
print(Torchvision.__version__) # 打印版本号，未报错即成功
</pre>
<h3 id="6-2-问题及解决">6.2 问题及解决</h3>
<p>6.2.1. 激活环境失败，报错输出：<code>workon command not find</code><br>
输入命令<code>source virtualenvwrapper.sh # 输入之后再尝试激活即可</code><br>
6.2.2. import torch时报错,Illegal instruction (core dumped)</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 修改环境变量</span>
<span class="token function">sudo</span> gedit /etc/profile 
<span class="token builtin class-name">export</span> <span class="token assign-left variable">OPENBLAS_CORETYPE</span><span class="token operator">=</span>ARMV8 <span class="token comment"># 将其加入最后面一行，然后保存</span>
<span class="token comment"># 更新环境变量</span>
<span class="token builtin class-name">source</span> /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>6.2.3. import torchvision报错<br>
[该报错大致可以分为两个问题]: 1、pillow和torchvision版本不对应出错；2、当前路径含有同名文件导致报错</p>
<ol>
<li>在import torchvision过程中遇到有关PIL库的提示报错<br>
解决方法：尝试卸载当前的pillow，安装较低版本的pillow<br>
输入命令：<pre name="code" class="python">
pip uninstall pillow
pip install pillow==6.1 # 一般来说安装此版本即可解决问题
</pre>
</li>
<li>由于当前在torchvision文件夹下安装的torchvision，若不退出此路径也会导致import torchvision报错，报错提示路径问题<br>
解决方法：退出当前文件夹路径，输入以下命令：<br>
<code>cd .. # 返回上级路径，然后再次尝试import torchvision</code></li>
</ol>
<h2 id="七、安装opencv">七、安装opencv</h2>
<h3 id="7-1-情形一">7.1 情形一</h3>
<p><a href="%E5%A6%82%E6%9E%9C%E5%9C%A8%E5%AE%89%E8%A3%85jetpack%E6%97%B6%E6%9C%AA%E5%AE%89%E8%A3%85opencv%EF%BC%8C%E6%88%96%E8%80%85%E6%98%AF%E6%83%B3%E6%8D%A2%E6%96%B0%E7%9A%84%E7%89%88%E6%9C%AC%EF%BC%8C%E5%A6%823.4.5%E3%80%82%E5%88%99%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E4%BB%A5%E4%B8%8B%E6%96%B9%E6%B3%95%E5%AE%89%E8%A3%85opencv">^具体阐述</a>: 在新创建的python虚拟环境中，无法import cv2，且pip install opencv-python始终无法完成，故需要安装opencv，但是一般来说，安装jetpack后，自动安装的有opencv，若此opencv版本不影响你的代码，那么就可以进行以下操作便捷使用opencv库了</p>
<ol>
<li>首先在终端执行以下指令查找编译好的cv2库文件的路径</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">find</span> / <span class="token parameter variable">-iname</span> <span class="token string">"*cv2*"</span> <span class="token comment"># 得到类似路径/usr/lib/python3.6/dist-packages/cv2/python-3.6/cv2.cython-36m-aarch64-linux-gnu.so，重点是cv2.cython-36m-aarch64-linux-gnu.so文件要求一致</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol start="2">
<li>随后进入虚拟环境的site-packages文件夹下,并链接到查找到的cv2库文件路径即可</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /home/nx407/.virtualenv/torchli/lib/python3.6/site-packages <span class="token comment"># 其中nx407是用户名、torchli是我建立的虚拟环境名</span>
<span class="token function">ln</span> <span class="token parameter variable">-s</span> /usr/lib/python3.6/dist-packages/cv2/python-3.6/cv2.cython-36m-aarch64-linux-gnu.so cv2.so  <span class="token comment"># 注意ln，link的意思，不是大写i</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ol start="3">
<li>安装完成后，在虚拟环境中执行下列指令以确保python能正确调用cv2。</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">python               <span class="token operator">//</span>进入python
<span class="token keyword">import</span> cv2
cv2<span class="token punctuation">.</span>__version__    <span class="token operator">//</span>若安装成功且能正常调用，此处能输出安装的从v版本
quit<span class="token punctuation">(</span><span class="token punctuation">)</span>               <span class="token operator">//</span>退出python<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="7-2-情形二">7.2 情形二</h3>
<ol>
<li>
<p>查看已预安装Opencv版本<br>
<code>pkg-config --modversion opencv</code></p>
</li>
<li>
<p>卸载原Opencv</p>
</li>
</ol>
<ul>
<li>如果是自己之前安装的话，就找到当初安装Opencv的build文件夹路径，然后进入该build目录执行卸载操作：</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>./opencv-4.x.x/build
<span class="token function">sudo</span> <span class="token function">make</span> uninstall
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>./opencv-4.x.x
<span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-r</span> build<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>若不是则执行以下操作：</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> purge libopencv*
<span class="token function">sudo</span> <span class="token function">apt-get</span> purge python-numpy
<span class="token function">sudo</span> <span class="token function">apt</span> autoremove // 删除其他未使用的apt包，可有可无
<span class="token function">sudo</span> <span class="token function">apt-get</span> update
<span class="token function">sudo</span> <span class="token function">apt-get</span> dist-upgrade<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li>
<p>下载Opencv3.4.5.zip文件</p>
</li>
<li>
<p>安装一些相关库和包</p>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> installbuild-essential 
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> cmake <span class="token function">git</span> libgtk2.0-dev pkg-config libavcodec-dev libavformat-dev libswscale-dev
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> python-dev python-numpy libtbb2 libtbb-dev libjpeg-dev libpng-dev libtiff-dev libjasper-dev libdc1394-22-dev
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> --only-upgrade g++-5 cpp-5 gcc-5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>如果上述指令失败的话，可以尝试网上换源，如下<br>
更新后再安装Qt5<br>
<code>sudo apt-get install qt5-default # qt5必须要安装成功，不过丢包概率不大，都能装上的</code></p>
<ol start="5">
<li>
<p>CUDA部分源码的修改<br>
先找到<code>cuda_gl_interop.h</code>文件，一般都是在<code>/usr/local/cuda/include</code>里<br>
然后在命令框输入<br>
<code>sudo gedit /usr/local/cuda/include/cuda_gl_interop.h</code><br>
这时会弹出一个文件如下图<br>
<img src="/images/Jetson/image-20230322013045837.png" alt="image-20230322013045837"><br>
找到红框内代码，并按照图中代码更改为以上内容，然后点save保存，退出。</p>
</li>
<li>
<p>开始编译安装opencv-3.4.5<br>
找到opencv-3.4.5所在文件夹（即前文解压后的文件夹），然后cd到build文件夹里面。<br>
控制台输入：</p>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cmake <span class="token parameter variable">-D</span> <span class="token assign-left variable">CMAKE_BUILD_TYPE</span><span class="token operator">=</span>RELEASE <span class="token parameter variable">-D</span> <span class="token assign-left variable">CMAKE_INSTALL_PREFIX</span><span class="token operator">=</span>/usr/local <span class="token punctuation">\</span>
      <span class="token parameter variable">-D</span> <span class="token assign-left variable">WITH_CUDA</span><span class="token operator">=</span>ON <span class="token parameter variable">-D</span> <span class="token assign-left variable">CUDA_ARCH_BIN</span><span class="token operator">=</span><span class="token string">"6.2"</span> <span class="token parameter variable">-D</span> <span class="token assign-left variable">CUDA_ARCH_PTX</span><span class="token operator">=</span><span class="token string">""</span> <span class="token punctuation">\</span>
      <span class="token parameter variable">-D</span> <span class="token assign-left variable">WITH_CUBLAS</span><span class="token operator">=</span>ON <span class="token parameter variable">-D</span> <span class="token assign-left variable">ENABLE_FAST_MATH</span><span class="token operator">=</span>ON <span class="token parameter variable">-D</span> <span class="token assign-left variable">CUDA_FAST_MATH</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
      <span class="token parameter variable">-D</span> <span class="token assign-left variable">ENABLE_NEON</span><span class="token operator">=</span>ON <span class="token parameter variable">-D</span> <span class="token assign-left variable">WITH_LIBV4L</span><span class="token operator">=</span>ON <span class="token parameter variable">-D</span> <span class="token assign-left variable">BUILD_TESTS</span><span class="token operator">=</span>OFF <span class="token punctuation">\</span>
      <span class="token parameter variable">-D</span> <span class="token assign-left variable">BUILD_PERF_TESTS</span><span class="token operator">=</span>OFF <span class="token parameter variable">-D</span> <span class="token assign-left variable">BUILD_EXAMPLES</span><span class="token operator">=</span>OFF <span class="token punctuation">\</span>
      <span class="token parameter variable">-D</span> <span class="token assign-left variable">WITH_QT</span><span class="token operator">=</span>ON <span class="token parameter variable">-D</span> <span class="token assign-left variable">WITH_OPENGL</span><span class="token operator">=</span>ON<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>接着输入：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">make</span>
<span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ol start="7">
<li>配置opencv环境：<br>
<code>sudo gedit /etc/ld.so.conf.d/opencv.conf # 创建并打开该文件，输入以下内容</code><br>
<img src="/images/Jetson/image-20230322013134812.png" alt="image-20230322013134812"><br>
执行下面的命令，使得刚才配置的路径生效<br>
<code>sudo ldconfig</code><br>
然后打开bash.bashrc文件<br>
<code>sudo gedit /etc/bash.bashrc</code><br>
在打开文件的最后加入如下命令</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">PKG_CONFIG_PATH</span><span class="token operator">=</span><span class="token variable">$PKG_CONFIG_PATH</span>:/usr/local/lib/pkgconfig
<span class="token builtin class-name">export</span> PKG_CONFIG_PATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>如图：<br>
<img src="/images/Jetson/img1.png" alt="img1"><br>
然后保存文件，使其生效<br>
<code>source /etc/bash.bashrc</code></p>
<ol start="8">
<li>检查是否成功安装opencv<br>
可以先在jtop查看opencv的安装版本，正确安装后会显示：<br>
<img src="/images/Jetson/image-20230322013148567.png" alt="image-20230322013148567"></li>
<li>之后连接一个摄像头，在终端输入，测试opencv是否能正常使用：</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /opencv-3.4.5/samples/cpp/example_cmake
cmake <span class="token builtin class-name">.</span>
<span class="token function">make</span>
<span class="token comment"># 成功make后，执行</span>
./opencv_example<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="10">
<li>上述<code>./opencv_example</code>命令如果失败，原因可能是摄像头的索引错误，<br>
输入<code>ls usb</code><br>
查看摄像头，发现video1<br>
换一个usb接口插入即可，再执行上述命令，可以发现摄像头成功打开。</li>
</ol>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2023/05/18/build_web/" title="关于如何使用Hexo搭建自己的Github网站"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: 关于如何使用Hexo搭建自己的Github网站</span></a><a class="button is-default" href="/2023/05/18/Torch2Trt/" title="成功解决Pytorch模型转trt模型中得BatchNorm问题"><span class="has-text-weight-semibold">下一页: 成功解决Pytorch模型转trt模型中得BatchNorm问题</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="lzule/lzule.github.io" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article><article class="mt-6 comment-container" id="vcomments"></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/lzule"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><a title="rss" target="_blank" rel="noopener nofollow" href="/atom.xml"><i class="iconfont icon-rss"></i></a><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> 李祖乐 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>